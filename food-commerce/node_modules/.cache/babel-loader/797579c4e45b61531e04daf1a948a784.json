{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alexandreborges\\\\Desktop\\\\DEV\\\\Ecommerce\\\\food-commerce\\\\src\\\\contexts\\\\CartContext.tsx\",\n    _s = $RefreshSig$();\n\nimport { createContext, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { snackEmoji } from '../helpers/snackEmoji';\nimport { processCheckout } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CartContext = /*#__PURE__*/createContext({});\nconst localStorageKey = '@foodCommerce:cart';\nexport function CartProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [cart, setCart] = useState(() => {\n    const value = localStorage.getItem(localStorageKey);\n    if (value) return JSON.parse(value);\n    return [];\n  });\n\n  function saveCart(items) {\n    setCart(items);\n    localStorage.setItem(localStorageKey, JSON.stringify(items));\n  }\n\n  function clearCart() {\n    localStorage.removeItem(localStorageKey);\n    setCart([]);\n  }\n\n  function addSnackIntoCart(snack) {\n    const snackExistentInCart = cart.find(item => item.snack === snack.snack && item.id === snack.id);\n\n    if (snackExistentInCart) {\n      const newCart = cart.map(item => {\n        if (item.id === snack.id) {\n          const quantity = item.quantity + 1;\n          const subtotal = item.price * quantity;\n          return { ...item,\n            quantity,\n            subtotal\n          };\n        }\n\n        return item;\n      });\n      toast.success(`Outro(a) ${snackEmoji(snack.snack)} ${snack.name} adicionado nos pedidos!`);\n      saveCart(newCart);\n      return;\n    }\n\n    const newSnack = { ...snack,\n      quantity: 1,\n      subtotal: snack.price\n    };\n    const newCart = [...cart, newSnack]; // push de um array\n\n    toast.success(`${snackEmoji(snack.snack)} ${snack.name} adicionado nos pedidos!`);\n    saveCart(newCart);\n  }\n\n  function removeSnackFromCart(snack) {\n    const newCart = cart.filter(item => !(item.id === snack.id && item.snack === snack.snack));\n    saveCart(newCart);\n  }\n\n  function updateSnackQuantity(snack, newQuantity) {\n    if (newQuantity <= 0) return;\n    const snackExistentInCart = cart.find(item => item.id === snack.id && item.snack === snack.snack);\n    if (!snackExistentInCart) return;\n    const newCart = cart.map(item => {\n      if (item.id === snackExistentInCart.id && item.snack === snackExistentInCart.snack) {\n        return { ...item,\n          quantity: newQuantity,\n          subtotal: item.price * newQuantity\n        };\n      }\n\n      return item;\n    });\n    saveCart(newCart);\n  }\n\n  function snackCartIncrement(snack) {\n    updateSnackQuantity(snack, snack.quantity + 1);\n  }\n\n  function snackCartDecrement(snack) {\n    updateSnackQuantity(snack, snack.quantity - 1);\n  }\n\n  function confirmOrder() {\n    navigate('/payment');\n  }\n\n  async function payOrder(customer) {\n    try {\n      const response = await processCheckout(cart, customer);\n\n      if (response.data.status !== 'PAID') {\n        toast.error('Erro ao processar o pagamento, por favor, tente novamente mais tarde.');\n        return;\n      }\n\n      clearCart();\n      navigate('/order/success');\n    } catch (error) {\n      console.error(error);\n      toast.error('Erro ao processar o pedido.');\n    }\n\n    return;\n  }\n\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      addSnackIntoCart,\n      removeSnackFromCart,\n      snackCartIncrement,\n      snackCartDecrement,\n      confirmOrder,\n      payOrder\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CartProvider, \"ypW38os466AVMi7+bP/XycUOQ8U=\", false, function () {\n  return [useNavigate];\n});\n\n_c = CartProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["createContext","useState","useNavigate","toast","snackEmoji","processCheckout","CartContext","localStorageKey","CartProvider","children","navigate","cart","setCart","value","localStorage","getItem","JSON","parse","saveCart","items","setItem","stringify","clearCart","removeItem","addSnackIntoCart","snack","snackExistentInCart","find","item","id","newCart","map","quantity","subtotal","price","success","name","newSnack","removeSnackFromCart","filter","updateSnackQuantity","newQuantity","snackCartIncrement","snackCartDecrement","confirmOrder","payOrder","customer","response","data","status","error","console"],"sources":["C:/Users/alexandreborges/Desktop/DEV/Ecommerce/food-commerce/src/contexts/CartContext.tsx"],"sourcesContent":["import { createContext, ReactNode, useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { toast } from 'react-toastify'\n\nimport { CustomerData } from '../interfaces/CustomerData'\nimport { SnackData } from '../interfaces/SnackData'\n\nimport { snackEmoji } from '../helpers/snackEmoji'\nimport { processCheckout } from '../services/api'\n\ninterface Snack extends SnackData {\n  quantity: number\n  subtotal: number\n}\n\ninterface CartContextProps {\n  cart: Snack[]\n  addSnackIntoCart: (snack: SnackData) => void\n  removeSnackFromCart: (snack: Snack) => void\n  snackCartIncrement: (snack: Snack) => void\n  snackCartDecrement: (snack: Snack) => void\n  confirmOrder: () => void\n  payOrder: (customer: CustomerData) => void\n}\n\ninterface CartProviderProps {\n  children: ReactNode\n}\n\nexport const CartContext = createContext({} as CartContextProps)\n\nconst localStorageKey = '@foodCommerce:cart'\n\nexport function CartProvider({ children }: CartProviderProps) {\n  const navigate = useNavigate()\n  const [cart, setCart] = useState<Snack[]>(() => {\n    const value = localStorage.getItem(localStorageKey)\n\n    if (value)return JSON.parse(value)\n\n    return []\n  })\n\n  function saveCart(items: Snack[]) {\n    setCart(items)\n    localStorage.setItem(localStorageKey, JSON.stringify(items))\n  }\n\n  function clearCart(){\n    localStorage.removeItem(localStorageKey)\n    setCart([])\n  }\n\n  function addSnackIntoCart(snack: SnackData): void {\n    const snackExistentInCart = cart.find(\n      (item) => item.snack === snack.snack && item.id === snack.id,\n    )\n\n    if (snackExistentInCart) {\n      const newCart = cart.map((item) => {\n        if (item.id === snack.id) {\n          const quantity = item.quantity + 1\n          const subtotal = item.price * quantity\n\n          return { ...item, quantity, subtotal }\n        }\n\n        return item\n      })\n\n      toast.success(`Outro(a) ${snackEmoji(snack.snack)} ${snack.name} adicionado nos pedidos!`)\n      saveCart(newCart)\n\n      return\n    }\n\n    const newSnack = { ...snack, quantity: 1, subtotal: snack.price }\n    const newCart = [...cart, newSnack] // push de um array\n\n    toast.success(`${snackEmoji(snack.snack)} ${snack.name} adicionado nos pedidos!`)\n    saveCart(newCart)\n  }\n\n  function removeSnackFromCart(snack: Snack) {\n    const newCart = cart.filter((item) => !(item.id === snack.id && item.snack === snack.snack))\n\n    saveCart(newCart)\n  }\n\n  function updateSnackQuantity(snack: Snack, newQuantity: number) {\n    if (newQuantity <= 0) return\n\n    const snackExistentInCart = cart.find(\n      (item) => item.id === snack.id && item.snack === snack.snack,\n    )\n\n    if (!snackExistentInCart) return\n\n    const newCart = cart.map((item) => {\n      if (item.id === snackExistentInCart.id && item.snack === snackExistentInCart.snack) {\n        return {\n          ...item,\n          quantity: newQuantity,\n          subtotal: item.price * newQuantity,\n        }\n      }\n\n      return item\n    })\n\n    saveCart(newCart)\n  }\n\n  function snackCartIncrement(snack: Snack) {\n    updateSnackQuantity(snack, snack.quantity + 1)\n  }\n\n  function snackCartDecrement(snack: Snack) {\n    updateSnackQuantity(snack, snack.quantity - 1)\n  }\n\n  function confirmOrder() {\n    navigate('/payment')\n  }\n\n  async function payOrder(customer: CustomerData) {\n    try {\n      const response = await processCheckout(cart, customer)\n      if (response.data.status !== 'PAID') {\n        toast.error('Erro ao processar o pagamento, por favor, tente novamente mais tarde.')\n        return\n      }\n      clearCart()\n      navigate('/order/success')\n    } catch (error) {\n      console.error(error)\n      toast.error('Erro ao processar o pedido.')\n    }\n    return\n  }\n\n  return (\n    <CartContext.Provider\n      value={{\n        cart,\n        addSnackIntoCart,\n        removeSnackFromCart,\n        snackCartIncrement,\n        snackCartDecrement,\n        confirmOrder,\n        payOrder,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}